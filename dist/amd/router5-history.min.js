define("router5HistoryPlugin",function(){"use strict";var t=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},e=function(t){return function(){return t}},a=function(){},n="undefined"!=typeof window,r=function(){return window.location.pathname.replace(/\/$/,"")},o=function(t,e,a){return window.history.pushState(t,e,a)},i=function(t,e,a){return window.history.replaceState(t,e,a)},s=function(t){return window.addEventListener("popstate",t)},u=function(t){return window.removeEventListener("popstate",t)},c=function(t){var e=t.useHash?window.location.hash.replace(new RegExp("^#"+t.hashPrefix),""):window.location.pathname.replace(new RegExp("^"+t.base),"");return(e||"/")+window.location.search},l=function(){return window.history.state},p={};p=n?{getBase:r,pushState:o,replaceState:i,addPopstateListener:s,removePopstateListener:u,getLocation:c,getState:l}:{getBase:e(""),pushState:a,replaceState:a,addPopstateListener:a,removePopstateListener:a,getLocation:e(""),getState:e(null)};var f=p,d=f.pushState,v=f.replaceState,g=f.addPopstateListener,w=f.removePopstateListener,S=f.getLocation,m=f.getBase,h=f.getState,L="HISTORY",P=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],a=e.forceDeactivate;return function(e){e.getLocation=function(){return S(e.options)},e.replaceHistoryState=function(t){var a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=e.buildState(t,a),r=e.buildUrl(t,a);e.lastKnownState=n,v(n,"",r)};var n=function(t,e,a){a?v(t,"",e):d(t,"",e)},r=function(r){var o=!r.state||!r.state.name,i=o?e.matchPath(S(e.options)):r.state,s=e.options,u=s.defaultRoute,c=s.defaultParams;if(!i)return void e.navigate(u,c,{forceDeactivate:a,reload:!0,replace:!0});if(!e.lastKnownState||!e.areStatesEqual(i,e.lastKnownState,!1)){var l=t({},e.getState());e._transition(i,l,{forceDeactivate:a},function(t,r){if(t)if(t.redirect)e.navigate(t.redirect.name,t.redirect.params,{forceDeactivate:a,replace:!0});else if("CANNOT_DEACTIVATE"===t){var s=e.buildUrl(e.lastKnownState.name,e.lastKnownState.params);o||n(i,s,!0)}else e.navigate(u,c,{forceDeactivate:a,reload:!0,replace:!0});else e._invokeListeners("$$success",r,l,{replace:!0})})}},o=function(){e.options.useHash&&!e.options.base&&(e.options.base=m()),g(r)},i=function(){w(r)},s=function(t,a,r){var o=h(),i=r.replace||a&&e.areStatesEqual(t,a,!1)||r.reload&&o&&e.areStatesEqual(t,o,!1);n(t,e.buildUrl(t.name,t.params),i)};return{name:L,onStart:o,onStop:i,onTransitionSuccess:s,onPopState:r}}};return P});