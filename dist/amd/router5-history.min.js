define("router5HistoryPlugin",[],function(){"use strict";function t(){function t(t,e,n){n?r(t,"",e):i(t,"",e)}function e(e){console.log(e,e.state,this.lastKnownState);var n=!e.state||!e.state.name,a=e.state||l.matchPath(p.getLocation(l.options)),o=l.options,i=o.defaultRoute,r=o.defaultParams;return a?void(l.lastKnownState&&l.areStatesEqual(a,l.lastKnownState,!0)||l._transition(a,l.lastKnownState,function(e,o){if(e)if("CANNOT_DEACTIVATE"===e){var s=l.buildUrl(l.lastKnownState.name,l.lastKnownState.params);n||t(a,s,!0)}else l.navigate(i,r,{reload:!0,replace:!0});else t(o,l.buildUrl(o.name,o.params),!n)})):void l.navigate(i,r,{reload:!0,replace:!0})}function n(t){l=t,l.getLocation=function(){return p.getLocation(l.options)}}function a(){l.options.useHash&&l.options.base&&(l.options.base=p.getBase()),s(e)}function o(){u(e)}function c(e,n,a){t(e,l.buildUrl(e.name,e.params),a.replace||a.reload)}var l=void 0;return{name:d,init:n,onStart:a,onStop:o,onTransitionSuccess:c,onPopState:e}}var e=function(t){return function(){return t}},n=function(){},a="undefined"!=typeof window,o=function(){return window.location.pathname.replace(/\/$/,"")},i=function(t,e,n){return window.history.pushState(t,e,n)},r=function(t,e,n){return window.history.replaceState(t,e,n)},s=function(t){return window.addEventListener("popstate",t)},u=function(t){return window.removeEventListener("popstate",t)},c=function(t){var e=t.useHash?window.location.hash.replace(new RegExp("^#"+t.hashPrefix),""):window.location.pathname.replace(new RegExp("^"+t.base),"");return e+window.location.search},l=function(){return window.history.state},p={};p=a?{getBase:o,pushState:i,replaceState:r,addPopstateListener:s,removePopstateListener:u,getLocation:c,getState:l}:{getBase:e(""),pushState:n,replaceState:n,addPopstateListener:n,removePopstateListener:n,getLocation:e(""),getState:e(null)};var d="HISTORY";return t});